:root{
  --text:#1f2937; --muted:#6b7280; --line:#d1d5db;
  --panelA: rgba(255,255,255,.64); --panelB: rgba(255,255,255,.48);
  --glass-border: rgba(30,44,80,0.14);
  --cellTop:#ffffff; --cellBottom:#f6f8fe;
  --radius:16px; --shadow:0 10px 26px rgba(0,0,0,.14);
}

*{box-sizing:border-box} html,body{height:100%}
body{ margin:0; color:var(--text); font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","Inter","Segoe UI",Roboto,Arial,sans-serif; overflow:hidden; background:#e0f2ff; }

/* ==== Волновой фон ==== */
.waves{ position:fixed; inset:0; z-index:-2; overflow:hidden; background:linear-gradient(to bottom,#dff6ff 0%,#b9e9ff 60%,#9ad5ff 100%); }
.wave{
  position:absolute; left:0; bottom:0; width:200%; height:120px;
  background-repeat: repeat-x;
  background-size: 50% 100%;
  opacity:.5;
  will-change: transform;
}
.layer1{ background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="1600" height="120"><path d="M0 67 C 273 267 822 -93 1600 67 V120 H0 Z" fill="%23ffffff"/></svg>'); animation: wave1 12s linear infinite; opacity:.35;}
.layer2{ background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="1600" height="120"><path d="M0 77 C 273 277 822 -83 1600 77 V120 H0 Z" fill="%23ffffff"/></svg>'); animation: wave2 18s linear infinite; opacity:.55;}
.layer3{ background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="1600" height="120"><path d="M0 87 C 273 287 822 -73 1600 87 V120 H0 Z" fill="%23ffffff"/></svg>'); animation: wave3 24s linear infinite; opacity:.75;}
@keyframes wave1{ 0%{transform:translateX(0);} 100%{transform:translateX(-50%);} }
@keyframes wave2{ 0%{transform:translateX(0);} 100%{transform:translateX(-50%);} }
@keyframes wave3{ 0%{transform:translateX(0);} 100%{transform:translateX(-50%);} }

/* Верхняя панель */
.topbar{
  position:fixed; top:0; left:0; right:0; height:64px;
  display:flex; align-items:center; justify-content:space-between; padding:0 10px;
  background: linear-gradient(180deg,var(--panelA),var(--panelB));
  border-bottom:1px solid var(--glass-border);
  backdrop-filter: blur(8px) saturate(140%);
  z-index:5;
}
.title{ display:flex; align-items:center; gap:8px; margin:0 auto; font-weight:800; letter-spacing:.2px; }
.title #monthLabel{ font-size:18px; }
.title .year{ font-size:13px; font-weight:700; padding:.15rem .5rem; border-radius:999px; background:#eef2ff; border:1px solid var(--glass-border); color:#374151; }
.nav.mini{ width:38px; height:38px; border-radius:999px; border:1px solid var(--glass-border); background:linear-gradient(180deg,var(--panelA),var(--panelB)); color:#374151; font-size:22px; font-weight:700; display:grid; place-items:center; cursor:pointer; }

/* Контент */
.viewport{ position:fixed; top:64px; bottom:0; left:0; right:0; padding:10px; z-index:1; }

.month-card{
  height:100%; width:100%;
  background: linear-gradient(180deg, var(--panelA), var(--panelB));
  border:1px solid var(--glass-border);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding:10px;
  display:grid;
  grid-template-rows: auto 1fr;
}
.weekdays{ display:grid; grid-template-columns:repeat(7,1fr); gap:6px; margin-bottom:6px; }
.weekday{ text-align:center; font-size:12px; color:var(--muted); text-transform:uppercase; letter-spacing:.6px; }

.grid{ height:100%; display:grid; grid-template-columns:repeat(7,1fr); grid-template-rows:repeat(6,1fr); gap:6px; }

.day{
  position:relative; display:flex; flex-direction:column; align-items:center; justify-content:flex-start;
  border:1px solid var(--line); border-radius:12px; color:var(--text);
  background: linear-gradient(180deg, var(--cellTop), var(--cellBottom));
  user-select:none; cursor:pointer; transition: transform .06s, background .2s, border-color .2s, box-shadow .2s;
  overflow:hidden;
  touch-action: manipulation; /* убираем двойной-тап-зуум, чтобы двойное нажатие ловилось */
  will-change: transform;
}
.day:hover{ transform: translateY(-1px); }
.day.empty{ background:transparent; border-style: solid; border-color: var(--line); cursor:default; }

.num{ font-weight:800; font-size:16px; line-height:1; pointer-events:none; margin-top:8px; margin-bottom:4px; }
.label-slot{ min-height:28px; display:flex; flex-direction:column; align-items:center; justify-content:flex-start; gap:2px; }
.badge{ font-size:10px; line-height:1; color:#374151; white-space:nowrap; }
.icon{ font-size:12px; line-height:1; }

/* Состояния */
.day.state-green{
  background: linear-gradient(180deg, #34d399, #22c55e);
  border-color:#16a34a; box-shadow: 0 0 0 1px rgba(34,197,94,.25), inset 0 0 0 1px rgba(34,197,94,.12), 0 10px 20px rgba(34,197,94,.25);
  color:#062b16;
}
.day.state-red{
  background: linear-gradient(180deg, #f87171, #ef4444);
  border-color:#dc2626; box-shadow: 0 0 0 1px rgba(239,68,68,.25), inset 0 0 0 1px rgba(239,68,68,.12), 0 10px 20px rgba(239,68,68,.25);
  color:#300707;
}

/* Визуальный отклик */
.day.pulse{ animation: pulse .12s ease-out; }
@keyframes pulse{ 0%{ transform:scale(1); } 100%{ transform:scale(0.98); } }

/* Конфетти */
.confetti{ position:absolute; width:6px; height:6px; border-radius:2px; opacity:.98; animation: confetti 650ms ease-out forwards; pointer-events:none; }
@keyframes confetti{ 0%{ transform: translate(0,0) rotate(0); opacity:1; } 100%{ transform: translate(var(--dx), var(--dy)) rotate(var(--rot)); opacity:0; } }


/* Жёлтый (только для сегодняшнего дня в режиме 'none') */
.day.state-yellow{
  background: linear-gradient(180deg, #fde047, #facc15);
  border-color:#eab308;
  box-shadow: 0 0 0 1px rgba(250,204,21,.25), 0 10px 20px rgba(250,204,21,.25);
  color:#4a3a00;
}
